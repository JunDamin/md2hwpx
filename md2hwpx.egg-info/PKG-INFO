Metadata-Version: 2.4
Name: md2hwpx
Version: 0.2.0
Summary: Convert Markdown to HWPX (Korean Hancom Office format)
Home-page: https://github.com/msjang/md2hwpx
Author: md2hwpx Contributors
License: MIT
Project-URL: Source, https://github.com/msjang/md2hwpx
Project-URL: Tracker, https://github.com/msjang/md2hwpx/issues
Classifier: Programming Language :: Python :: 3
Classifier: License :: OSI Approved :: MIT License
Classifier: Operating System :: OS Independent
Requires-Python: >=3.9
Description-Content-Type: text/markdown
License-File: LICENSE
Requires-Dist: marko>=2.0.0
Requires-Dist: python-frontmatter>=1.0.0
Requires-Dist: Pillow
Dynamic: author
Dynamic: classifier
Dynamic: description
Dynamic: description-content-type
Dynamic: home-page
Dynamic: license
Dynamic: license-file
Dynamic: project-url
Dynamic: requires-dist
Dynamic: requires-python
Dynamic: summary

# md2hwpx

**md2hwpx**는 마크다운(`.md`)을 아래아 한글(`.hwpx`)로 변환해주는 파이썬 도구입니다. Pandoc 없이 순수 파이썬으로 동작합니다.

## 주요 기능

- **입력 형식**: 마크다운(`.md`)
- **출력 형식**: 아래아 한글문서(`.hwpx`)
- **이미지 처리**: 로컬 이미지를 참조하는 마크다운의 경우 이미지를 포함하여 hwpx 생성
- **고급 레이아웃**:
    - 참조용 HWPX 파일(`blank.hwpx`)의 스타일과 페이지 설정(여백 등)을 복제하여 사용합니다.

## 요구 사항

- **Python 3.6+**
- **Python 라이브러리**: marko, python-frontmatter, Pillow

## 설치

### PyPI 설치 (권장)

```bash
pip install md2hwpx
```

### 소스 설치

```bash
git clone https://github.com/msjang/md2hwpx.git
cd md2hwpx
pip install -e .
```

## 사용방법

커맨드 라인 도구(`md2hwpx`)를 사용하여 변환합니다.

```sh
# MD -> HWPX
md2hwpx test.md -o output.hwpx

# 참조 문서 지정
md2hwpx test.md --reference-doc=custom.hwpx -o output.hwpx
```

* `--reference-doc`: (선택) 스타일(글자 모양, 문단 모양, 용지 설정 등)을 가져올 기준 HWPX 파일. 지정하지 않으면 패키지에 내장된 기본 파일(`blank.hwpx`)을 사용합니다.

## 스타일 커스터마이징 (Template Customization)

한컴오피스에서 템플릿 HWPX 파일을 편집하여 출력 스타일을 커스터마이징할 수 있습니다. **플레이스홀더 방식**을 권장합니다.

### 방법 1: 플레이스홀더 방식 (권장)

한컴오피스에서 플레이스홀더 텍스트를 작성하고 원하는 서식을 적용하면, 변환 시 해당 서식이 그대로 적용됩니다.

#### 1. 템플릿 만들기

1. 한컴오피스에서 새 문서를 만듭니다
2. 다음 플레이스홀더를 입력하고 각각 원하는 서식을 적용합니다:

| 플레이스홀더 | 마크다운 요소 | 예시 서식 |
|-------------|--------------|----------|
| `{{H1}}` | `# 제목1` | 24pt, 파란색, 굵게 |
| `{{H2}}` | `## 제목2` | 18pt, 검정색, 굵게 |
| `{{H3}}` | `### 제목3` | 14pt, 검정색, 굵게 |
| `{{H4}}` ~ `{{H9}}` | `####` ~ `#########` | 원하는 서식 |
| `{{BODY}}` | 본문 텍스트 | 11pt, 검정색 |

3. 파일을 `my_template.hwpx`로 저장합니다

#### 2. 변환하기

```bash
md2hwpx input.md --reference-doc=my_template.hwpx -o output.hwpx
```

변환된 문서에서:
- `# 제목` → `{{H1}}`에 적용한 서식 (24pt, 파란색, 굵게)
- 본문 → `{{BODY}}`에 적용한 서식 (11pt, 검정색)

### 방법 2: 스타일 편집 방식

기본 템플릿의 스타일을 직접 편집하는 방식입니다.

#### 1. 기본 템플릿 복사

```bash
python -c "import md2hwpx; import shutil; shutil.copy(md2hwpx.__path__[0] + '/blank.hwpx', 'my_template.hwpx')"
```

#### 2. 한컴오피스에서 스타일 편집

1. `my_template.hwpx`를 한컴오피스에서 엽니다
2. **서식 > 스타일** 메뉴 (또는 `F6`)를 선택합니다
3. 원하는 스타일을 수정합니다:

| 스타일 이름 | 마크다운 요소 |
|------------|--------------|
| 바탕글 | 본문 텍스트 |
| 제목 1 ~ 제목 9 | `#` ~ `#########` |

#### 3. 커스텀 템플릿으로 변환

```bash
md2hwpx input.md --reference-doc=my_template.hwpx -o output.hwpx
```

### 커스터마이징 가능한 항목

- 글꼴 및 크기
- 글자 색상 및 배경색
- 문단 간격 (위/아래 여백, 줄 간격)
- 들여쓰기 및 정렬
- 페이지 여백 및 용지 크기

## 설명 및 제약사항

**md2hwpx**는 [Marko](https://github.com/frostming/marko) 라이브러리를 사용하여 마크다운을 AST(Abstract Syntax Tree)로 파싱한 뒤, 이를 아래아 한글(`.hwpx`) 규격에 맞춰 생성합니다. Pandoc 없이 순수 파이썬으로 동작합니다.

디버깅 및 개발 편의를 위해 중간 단계인 JSON AST 출력 기능을 제공합니다.

```sh
# 디버깅용 JSON 출력
md2hwpx test.md -o debug.json
```

## 예제 (Examples)

프로젝트 내 `tests/` 디렉토리에서 변환된 결과물(`*.hwpx`, `*.html`)과 원본 테스트 파일들을 확인할 수 있습니다.

## 프로젝트 구조

- `md2hwpx/cli.py`: 메인 실행 스크립트
- `md2hwpx/MarkdownToHwpx.py`: HWPX 변환 핵심 로직 (AST 파싱, XML 생성, Zip 처리)
- `md2hwpx/marko_adapter.py`: Marko AST를 Pandoc 형식으로 변환하는 어댑터
- `md2hwpx/frontmatter_parser.py`: YAML 프론트매터 파싱
- `md2hwpx/blank.hwpx`: HWPX 변환에 필수적인 참조용 템플릿 파일

## 라이선스 (License)

MIT License. 자세한 내용은 [LICENSE](LICENSE) 파일을 참고하세요.
